local PRIVATE_KEY =
"30820277020100300d06092a864886f70d0101010500048202613082025d02010002818100" +
"c2d8db0d4f9acb9936f678ac9b35a4448baf11755e593d660e12734af61c8127fde99ef1fe" +
"dc3b15eaf0eb71223a3011f8dc7871af7dced81b53702c387e91ae0987a42d62a3c42fd187" +
"7eb05eb9fca77748363c03d55f2481bce26bfc8b24fb8fc5b23e6286b20f82b439c13041b8" +
"b6230e0c0fa690bffaf75db2be70bb96db0203010001028180589912c1f2b8886b9aba6814" +
"d45e87db4348cfbf76af4d63e272314a9cae496c4de0b50d84bdcf801fdc7cb26cc5d8a5d3" +
"6b2cb944fb07daec51fc679f28ae449166c198bc160c9e7f40f94b2b5493c4fb3c07ff3d9a" +
"9f2c6646750319d21e157f6b775170ad6b55a99572a3cc745c8ce4f7d7fdaa4bdcc94be9bb" +
"2ad858a901024100ea7b109b84b3fa808e1f2183257669c2ddb289141305c7e2008aebe290" +
"5bc5d2c455801b821b6cb7ead47c04a470b68494b389f0901a83c0c580518122be87ab0241" +
"00d4baa174e28d3af90a5ee00fd6a56081184df7f820f8941b5a7a821a82c02cfe581c1665" +
"e2259e3ee0f87220e466c0582a97d6431474a997cac062c7e4773d91024100b542a915efc1" +
"c9b63327719a960d31b8c7f4c9eed0bdb944c6329e22a881a92d4344ed2156b4a8988c59f1" +
"fd0cb96cfe948d2de6df1f0016b71678eb20d6b4bd024100979928d6935cf259e7fa14d334" +
"b44641b98056e68d1898f3a55708c0bbcd184369a71a8f20ca8e2b6147ac8da437557b7f5f" +
"156258818b1a9172e8f26aee4f0102406ab2c28cbd7a97f57e52b1e18082af0faa44a99b91" +
"c5d6729155df6106d8ad83d46b3192e5effdbdea3baed4c71d40af1a7da3c765937e167f30" +
"29463363868d";

local PUBLIC_KEY =
"30819f300d06092a864886f70d010101050003818d0030818902818100c2d8db0d4f9acb99" +
"36f678ac9b35a4448baf11755e593d660e12734af61c8127fde99ef1fedc3b15eaf0eb7122" +
"3a3011f8dc7871af7dced81b53702c387e91ae0987a42d62a3c42fd1877eb05eb9fca77748" +
"363c03d55f2481bce26bfc8b24fb8fc5b23e6286b20f82b439c13041b8b6230e0c0fa690bf" +
"faf75db2be70bb96db0203010001";

// plaintext: RSA-Encrypt-Test
local PLAINTEXT = Buffer([
0x52, 0x53, 0x41, 0x2d, 0x45, 0x6e, 0x63, 0x72,
0x79, 0x70, 0x74, 0x2d, 0x54, 0x65, 0x73, 0x74
]);

local privateKeyBlob = Blob(Buffer(PRIVATE_KEY, "hex"), false);
local publicKeyBlob = Blob(Buffer(PUBLIC_KEY, "hex"), false);

local plainBlob = Blob(PLAINTEXT, false);

local encryptBlob = RsaAlgorithm.encrypt(publicKeyBlob, plainBlob);
local receivedBlob = RsaAlgorithm.decrypt(privateKeyBlob, encryptBlob);

print(plainBlob.equals(receivedBlob));
